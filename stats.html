
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BEDHEAD Stats Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 2em;
      background: linear-gradient(to bottom, #fff0c2, #ffd2d1);
      color: #333;
    }
    h1, h2 {
      text-align: center;
    }
    .section {
      max-width: 900px;
      margin: 2em auto;
      padding: 2em;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1em;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0.6em;
      text-align: center;
    }
    input[type="number"] {
      width: 100%;
      padding: 0.5em;
    }
    button {
      margin-top: 1em;
      padding: 0.7em 1.5em;
      font-size: 1em;
      background-color: #5ba3c7;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .result {
      margin-top: 1em;
      font-weight: bold;
      font-size: 1.2em;
    }
    canvas {
      max-width: 100%;
      margin-top: 1em;
    }
  </style>
</head>
<body>

<div class="logo" style="text-align:center; background:#fff; padding:2em 1em 0.5em;">
  <a href="index.html"><img src="logo2nobg.png" alt="BEDHEAD Logo" style="max-width: 340px; height: auto;"></a>
</div>
<nav style="text-align: center; background: #fff; padding: 1em;">
  <a href="index.html" style="margin: 0 1em; color: #333; text-decoration: none;">Home</a>
  <a href="about.html" style="margin: 0 1em; color: #333; text-decoration: none;">About Us</a>
  <a href="howto.html" style="margin: 0 1em; color: #333; text-decoration: none;">How to Use Your Journal</a>
  <a href="resources.html" style="margin: 0 1em; color: #333; text-decoration: none;">Resources</a>
  <a href="vitamindex.html" style="margin: 0 1em; color: #333; text-decoration: none;">Vitamindex</a>
  <a href="soundbath.html" style="margin: 0 1em; color: #333; text-decoration: none;">Soundbath Room</a>
  <a href="stats.html" style="margin: 0 1em; color: #333; text-decoration: underline;">Stats Calculator</a>
</nav>


<div class="section" id="weekly-correlation">
  <h2>Weekly Correlation Calculator</h2>
  <p>This tool helps you understand the relationship between number of activities completed and number of symptoms experienced across a single week. A strong negative correlation (closer to -1) suggests that more activity leads to fewer symptoms, while a positive correlation suggests the opposite.</p>
  <table id="week-table">
    <tr><th>Day</th><th>Activities Completed</th><th>Symptoms</th></tr>
    <tr><td>Mon</td><td><input type="number"></td><td><input type="number"></td></tr>
    <tr><td>Tue</td><td><input type="number"></td><td><input type="number"></td></tr>
    <tr><td>Wed</td><td><input type="number"></td><td><input type="number"></td></tr>
    <tr><td>Thu</td><td><input type="number"></td><td><input type="number"></td></tr>
    <tr><td>Fri</td><td><input type="number"></td><td><input type="number"></td></tr>
    <tr><td>Sat</td><td><input type="number"></td><td><input type="number"></td></tr>
    <tr><td>Sun</td><td><input type="number"></td><td><input type="number"></td></tr>
  </table>
  <button onclick="calculateCorrelation('week-table', 'week-result', 'week-graph')">Calculate Weekly r</button>
  <div class="result" id="week-result"></div>
  <canvas id="week-graph" height="200"></canvas>
</div>

<div class="section" id="weekly-variance">
  <h2>Weekly r Variance</h2>
  <p>To understand how consistent your symptom-activity relationship is over a month, enter the r values from each of your four weekly correlations below. This calculates variance and standard deviation.</p>
  <table id="var-table">
    <tr><th>Week</th><th>r Value</th></tr>
    <tr><td>Week 1</td><td><input type="number" step="0.01"></td></tr>
    <tr><td>Week 2</td><td><input type="number" step="0.01"></td></tr>
    <tr><td>Week 3</td><td><input type="number" step="0.01"></td></tr>
    <tr><td>Week 4</td><td><input type="number" step="0.01"></td></tr>
  </table>
  <button onclick="calculateVariance()">Calculate r Variance</button>
  <div class="result" id="variance-result"></div>
</div>

<div class="section" id="monthly-correlation">
  <h2>Monthly Correlation Calculator</h2>
  <p>Input your daily activity and symptom counts for a full 28-day cycle. The tool will calculate the correlation between the two.</p>
  <table id="month-table">
    <tr><th>Day</th><th>Activities</th><th>Symptoms</th></tr>
    <!-- JS will add 28 rows -->
  </table>
  <button onclick="calculateCorrelation('month-table', 'month-result', 'month-graph')">Calculate Monthly r</button>
  <div class="result" id="month-result"></div>
  <canvas id="month-graph" height="200"></canvas>
</div>

<script>
  // Add 28 rows to month table
  const mtable = document.getElementById("month-table");
  for (let i = 1; i <= 28; i++) {
    const row = document.createElement("tr");
    row.innerHTML = `<td>${i}</td><td><input type="number"></td><td><input type="number"></td>`;
    mtable.appendChild(row);
  }

  function calculateCorrelation(tableId, resultId, graphId) {
    const rows = document.querySelectorAll(`#${tableId} tr`);
    let x = [], y = [];
    rows.forEach((row, i) => {
      if (i === 0) return;
      const inputs = row.querySelectorAll("input");
      if (inputs.length >= 2) {
        const xi = parseFloat(inputs[0].value);
        const yi = parseFloat(inputs[1].value);
        if (!isNaN(xi) && !isNaN(yi)) {
          x.push(xi);
          y.push(yi);
        }
      }
    });
    const mean = arr => arr.reduce((a,b)=>a+b,0) / arr.length;
    const mx = mean(x), my = mean(y);
    let num = 0, dx = 0, dy = 0;
    for (let i = 0; i < x.length; i++) {
      const a = x[i] - mx;
      const b = y[i] - my;
      num += a * b;
      dx += a * a;
      dy += b * b;
    }
    const r = num / Math.sqrt(dx * dy);
    document.getElementById(resultId).textContent = `r = ${r.toFixed(2)} (${interpretCorrelation(r)})`;
    plotGraph(graphId, x, y);
  }

  function interpretCorrelation(r) {
    const abs = Math.abs(r);
    if (abs > 0.7) return "Strong";
    if (abs > 0.4) return "Moderate";
    if (abs > 0.2) return "Weak";
    return "None";
  }

  function calculateVariance() {
    const vals = Array.from(document.querySelectorAll('#var-table input')).map(el => parseFloat(el.value)).filter(v => !isNaN(v));
    if (vals.length !== 4) {
      document.getElementById("variance-result").textContent = "Please enter all four r values.";
      return;
    }
    const mean = vals.reduce((a,b) => a+b, 0) / vals.length;
    const variance = vals.map(v => (v - mean) ** 2).reduce((a,b) => a + b, 0) / vals.length;
    const sd = Math.sqrt(variance);
    document.getElementById("variance-result").textContent = `Variance = ${variance.toFixed(3)}, SD = ${sd.toFixed(3)} (${interpretVariance(sd)})`;
  }

  function interpretVariance(sd) {
    if (sd < 0.3) return "Stable";
    if (sd < 0.5) return "Mild Variability";
    return "Unstable";
  }

  function plotGraph(canvasId, xVals, yVals) {
    const ctx = document.getElementById(canvasId).getContext("2d");
    new Chart(ctx, {
      type: "bar",
      data: {
        labels: xVals.map((_, i) => `Day ${i + 1}`),
        datasets: [
          {
            label: "Activities",
            data: xVals,
            backgroundColor: "#5ba3c7"
          },
          {
            label: "Symptoms",
            data: yVals,
            type: "line",
            borderColor: "#d95f5f",
            fill: false,
            tension: 0.3
          }
        ]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: true }
        }
      }
    });
  }
</script>

</body>
</html>
